% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fun_gen.R
\name{dat.gen}
\alias{dat.gen}
\title{Generate  Data for the Bayesian Mixed-Effects Model for Multilevel Two-Way Functional Data (BMEF)}
\usage{
dat.gen(seed, n, J, TT, FF, K_T, K_F, U, V, Delta, X, Sigma2s)
}
\arguments{
\item{seed}{An integer seed for reproducibility.}

\item{J}{Number of experimental conditions.}

\item{TT}{Number of time points (equally spaced between 0 and 1).}

\item{FF}{Number of frequency points (equally spaced between 0 and 1).}

\item{K_T}{Number of marginal basis functions for the time dimension. (integer)}

\item{K_F}{Number of marginal basis functions for the frequency dimension. (integer)}

\item{U}{An orthonormal factor matrix of dimension \code{K_F × R}}

\item{V}{An orthonormal factor matrix of dimension \code{K_T × R}}

\item{Delta}{A 3D array of dimension \code{J × R × p}, representing covariate coefficients across conditions and components.}

\item{X}{A numeric matrix of subject-level covariates of dimension \code{n × p}.
The intercept should be included explicitly (e.g., for intercept-only, \code{p = 1}).}

\item{Sigma2S}{A list of variance components including:
\itemize{
  \item{\code{Sigma2_gamma}}: {A scalar representing \eqn{\sigma_{\gamma}^2}.}
  \item{\code{Sigma2_omega}}: {A numeric vector of length \code{n}, representing \eqn{\sigma_{\omega_i}^2}.}
  \item{\code{Sigma2_epsilon}}: {A scalar representing \eqn{\sigma_{\epsilon}^2}.}
}}
}
\value{
A list containing the following components:
 \item{tt}{A numeric vector of length \code{TT}, representing the time grid (equally spaced from 0 to 1).}
 \item{ff}{A numeric vector of length \code{FF}, representing the frequency grid (equally spaced from 0 to 1).}
 \item{O_tilde}{A matrix of dimension \code{(TT× FF) × K}, representing orthogonalized basis evaluations.}
 \item{A}{A 4D array of dimension \code{n × J × K_T × K_F}, storing the fixed effect coefficients \eqn{\alpha_j(x_i)} (for each [i,j] pair, arranged columnwise as a \code{K_T × K_F} matrix).}
 \item{B}{A 3D array of dimension \code{n × K_T × K_F}, storing subject-level random effects coefficients \eqn{\gamma_i} (for each [i], arranged ccolumnwise as a \code{K_T × K_F} matrix).}
 \item{C}{A 4D array of dimension \code{n × J × K_T × K_F}, storing subject-by-condition random effects coefficients \eqn{\omega_{i,j}} (for each [i,j] pair, arranged columnwise as a \code{K_T × K_F} matrix).}
 \item{Y}{A 3D array of dimension \code{n × J × (K_T × K_F)}, representing the observed two-way functional observations (with noise)}
}
\description{
This function generates synthetic data to illustrate and test the Bayesian Mixed-Effects Model
for Multilevel Two-Way Functional Data (BMEF). The simulated data include functional fixed effects and random effects, and noise
components over a time-frequency grid. Natural cubic B-splines are used as marginal bases for both the time and frequency dimensions.
}
